<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>Transferências de Uso do Solo - COS 2018 para 2023</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
    }
    h1 {
      text-align: center;
      padding: 40px;
      margin: 0;
      background-color: #008060;
      color: white;
    }
    #sankeyChart {
      width: 100%;
      height: 90vh;
      padding: 30px;
      box-sizing: border-box;
      background-color: #fff;
    }
  </style>
</head>
<body>
  <h1>Transferências de Uso do Solo – COS 2018 → 2023 (Torres Vedras)</h1>
  <div id="sankeyChart"></div>

  <script>
    const allLinks = [
      { source: 0, target: 6, value: 9.0, color: "rgba(255, 255, 0, 0.6)", customdata: "Territórios artificializados → Agricultura" },
      { source: 0, target: 8, value: 1.6, color: "rgba(0, 128, 0, 0.6)", customdata: "Territórios artificializados → Florestas" },
      { source: 0, target: 9, value: 12.9, color: "rgba(173, 255, 47, 0.6)", customdata: "Territórios artificializados → Matos" },

      { source: 1, target: 5, value: 41.6, color: "rgba(255, 0, 0, 0.6)", customdata: "Agricultura → Territórios artificializados" },
      { source: 1, target: 7, value: 15.4, color: "rgba(255, 165, 0, 0.6)", customdata: "Agricultura → Pastagens" },
      { source: 1, target: 8, value: 47.8, color: "rgba(0, 128, 0, 0.6)", customdata: "Agricultura → Florestas" },
      { source: 1, target: 9, value: 20.9, color: "rgba(173, 255, 47, 0.6)", customdata: "Agricultura → Matos" },
      { source: 1, target: 10, value: 6.5, color: "rgba(51, 153, 255, 0.6)", customdata: "Agricultura → Massas de água superficiais" },

      { source: 2, target: 5, value: 11.7, color: "rgba(255, 0, 0, 0.6)", customdata: "Pastagens → Territórios artificializados" },
      { source: 2, target: 6, value: 114.2, color: "rgba(255, 255, 0, 0.6)", customdata: "Pastagens → Agricultura" },
      { source: 2, target: 8, value: 17.9, color: "rgba(0, 128, 0, 0.6)", customdata: "Pastagens → Florestas" },

      { source: 3, target: 5, value: 50.6, color: "rgba(255, 0, 0, 0.6)", customdata: "Florestas → Territórios artificializados" },
      { source: 3, target: 6, value: 83.2, color: "rgba(255, 255, 0, 0.6)", customdata: "Florestas → Agricultura" },
      { source: 3, target: 7, value: 3.0, color: "rgba(255, 165, 0, 0.6)", customdata: "Florestas → Pastagens" },
      { source: 3, target: 9, value: 1.3, color: "rgba(173, 255, 47, 0.6)", customdata: "Florestas → Matos" },
      { source: 3, target: 10, value: 2.0, color: "rgba(51, 153, 255, 0.6)", customdata: "Florestas → Massas de água superficiais" },

      { source: 4, target: 5, value: 35.2, color: "rgba(255, 0, 0, 0.6)", customdata: "Matos → Territórios artificializados" },
      { source: 4, target: 6, value: 77.3, color: "rgba(255, 255, 0, 0.6)", customdata: "Matos → Agricultura" },
      { source: 4, target: 7, value: 1.0, color: "rgba(255, 165, 0, 0.6)", customdata: "Matos → Pastagens" },
      { source: 4, target: 8, value: 19.6, color: "rgba(0, 128, 0, 0.6)", customdata: "Matos → Florestas" }
    ];

   const nodeData = {
      pad: 100,
      thickness: 30,
      line: { color: "black", width: 1.5 },
      label: [
        "Territórios artificializados (2018)",   // 0
        "Agricultura (2018)",        // 1
        "Pastagens (2018)",          // 2
        "Florestas (2018)",          // 3
        "Matos (2018)",              // 4
        "Territórios artificializados (2023)",   // 5
        "Agricultura (2023)",        // 6
        "Pastagens (2023)",          // 7
        "Florestas (2023)",          // 8
        "Matos (2023)",              // 9
        "Massas de água superficiais (2023)" // 10
      ],
      color: [
        "#ff0000", "#ffff00", "#ffa500", "#008000", "#adff2f",
        "#ff0000", "#ffff00", "#ffa500", "#008000", "#adff2f", "#3399ff"
      ]
    };

    const link = {
      source: allLinks.map(l => l.source),
      target: allLinks.map(l => l.target),
      value: allLinks.map(l => l.value),
      color: allLinks.map(l => l.color),
      customdata: allLinks.map(l => l.customdata),
      hovertemplate: "<b>Transferência:</b> %{customdata}<br><b>Área:</b> %{value} ha<extra></extra>"
    };

    const data = [{
      type: "sankey",
      orientation: "h",
      node: nodeData,
      link: link
    }];

    const layout = {
      title: { text: "Transferências", font: { size: 30 } },
      font: { size: 25 },
      margin: { l: 70, r: 70, t: 140, b: 30 },
      annotations: [
        {
          text: "COS 2018",
          x: 0.0,
          y: 1.05,
          xref: 'paper',
          yref: 'paper',
          showarrow: false,
          font: { size: 30, color: 'black', family: 'Segoe UI' }
        },
        {
          text: "COS 2023",
          x: 1,
          y: 1.05,
          xref: 'paper',
          yref: 'paper',
          showarrow: false,
          font: { size: 30, color: 'black', family: 'Segoe UI' }
        }
      ]
    };

    Plotly.newPlot('sankeyChart', data, layout);
  </script>
</body>
</html>
